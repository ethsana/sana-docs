(self.webpackChunkant_docs=self.webpackChunkant_docs||[]).push([[4434],{3905:function(e,n,a){"use strict";a.d(n,{Zo:function(){return p},kt:function(){return m}});var t=a(7294);function o(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function r(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}function i(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?r(Object(a),!0).forEach((function(n){o(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function s(e,n){if(null==e)return{};var a,t,o=function(e,n){if(null==e)return{};var a,t,o={},r=Object.keys(e);for(t=0;t<r.length;t++)a=r[t],n.indexOf(a)>=0||(o[a]=e[a]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(t=0;t<r.length;t++)a=r[t],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var l=t.createContext({}),c=function(e){var n=t.useContext(l),a=n;return e&&(a="function"==typeof e?e(n):i(i({},n),e)),a},p=function(e){var n=c(e.components);return t.createElement(l.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},u=t.forwardRef((function(e,n){var a=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=c(a),m=o,k=u["".concat(l,".").concat(m)]||u[m]||d[m]||r;return a?t.createElement(k,i(i({ref:n},p),{},{components:a})):t.createElement(k,i({ref:n},p))}));function m(e,n){var a=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var r=a.length,i=new Array(r);i[0]=u;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s.mdxType="string"==typeof e?e:o,i[1]=s;for(var c=2;c<r;c++)i[c]=a[c];return t.createElement.apply(null,i)}return t.createElement.apply(null,a)}u.displayName="MDXCreateElement"},6375:function(e,n,a){"use strict";a.r(n),a.d(n,{frontMatter:function(){return s},metadata:function(){return l},toc:function(){return c},default:function(){return d}});var t=a(2122),o=a(9756),r=(a(7294),a(3905)),i=["components"],s={title:"Sana Using Docker",id:"docker"},l={unversionedId:"installation/docker",id:"installation/docker",isDocsHomePage:!1,title:"Sana Using Docker",description:"Docker containers for Sana are hosted at Docker Hub for your convenience.",source:"@site/docs/installation/docker.md",sourceDirName:"installation",slug:"/installation/docker",permalink:"/docs/installation/docker",editUrl:"https://github.com/ethsana/sana-docs/blob/master/sidebars.js/docs/installation/docker.md",version:"current",frontMatter:{title:"Sana Using Docker",id:"docker"}},c=[{value:"Quick Start",id:"quick-start",children:[]},{value:"Versions",id:"versions",children:[]},{value:"Docker Compose",id:"docker-compose",children:[]}],p={toc:c};function d(e){var n=e.components,a=(0,o.Z)(e,i);return(0,r.kt)("wrapper",(0,t.Z)({},p,a,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Docker containers for Sana are hosted at ",(0,r.kt)("a",{parentName:"p",href:"https://hub.docker.com/r/ethsana/sana"},"Docker Hub")," for your convenience. "),(0,r.kt)("p",null,"If running a Sana ",(0,r.kt)("em",{parentName:"p"},"full node"),", it is recommended that you make use of\nEthereum's external signer, ",(0,r.kt)("a",{parentName:"p",href:"/docs/installation/bee-clef"},"Clef"),". Skip\nahead if you are comfortable with ",(0,r.kt)("inlineCode",{parentName:"p"},"docker")," basics for instructions on\nhow to use ",(0,r.kt)("a",{parentName:"p",href:"/docs/installation/docker#docker-compose"},"docker-compose"),"\nto easily set up Bee with persistent storage and integration with the\nSana Clef container."),(0,r.kt)("h3",{id:"quick-start"},"Quick Start"),(0,r.kt)("p",null,"Try Sana out by simply running the following command in your Terminal. "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'docker run\\\n  -p 1635:1635 \\\n  -p 1634:1634 \\\n  -p 1633:1633\\\n  --rm -it ethsana/sana:stable\\\n  start \\\n    --welcome-message="Hello Sana" \\\n    --swap-endpoint https://stake.getblock.io/mainnet/?api_key=copy-your-api-key-here \\\n    --debug-api-enable\n')),(0,r.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"If starting your node for the first time, you will need to deploy a chequebook contract. See ",(0,r.kt)("a",{parentName:"p",href:"/docs/installation/manual"},"Manual Installation")," for more info."))),(0,r.kt)("p",null,"To persist files, mount a local directory as follows and enter the\npassword used to encrypt your keyfiles. Note, ",(0,r.kt)("inlineCode",{parentName:"p"},"docker")," insists on\nabsolute paths when mounting volumes, so you must replace\n",(0,r.kt)("inlineCode",{parentName:"p"},"/path/to/.sana-docker")," with a valid path from your local filesystem."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'docker run\\\n  -v /path/to/.sana-docker:/home/sana/.sana\\\n  -p 1635:1635 \\\n  -p 1634:1634 \\\n  -p 1633:1633\\\n  --rm -it ethsana/sana:stable\\\n  start \\\n    --welcome-message="Hello Sana" \\\n    --swap-endpoint https://stake.getblock.io/mainnet/?api_key=your-api-key \\\n      --debug-api-enable\n')),(0,r.kt)("p",null,"Once you have generated your keys, leave Sana to run in the background..."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'docker run\\\n  -d \n  -v /path/to/.sana-docker:/home/sana/.bee\\\n  -p 1635:1635 \\\n  -p 1634:1634 \\\n  -p 1633:1633\\\n  --rm -it ethsana/sana:stable\\\n  start \\\n    --welcome-message="Hello Sana" \\\n    --swap-endpoint https://stake.getblock.io/mainnet/?api_key=your-api-key \\\n      --debug-api-enable\n')),(0,r.kt)("h3",{id:"versions"},"Versions"),(0,r.kt)("p",null,"In order to avoid accidentally upgrading your Sana containers, or\ndeadlocks resulting from Docker caching solutions, it is recommended\nto use best practices and pin the specific version of Sana that you\nwant to run."),(0,r.kt)("h4",{id:"specific-versions"},"Specific Versions"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"docker pull ethsana/sana:0.0.3\n")),(0,r.kt)("h4",{id:"using-tags"},"Using Tags"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"docker pull ethsana/sana:beta\n")),(0,r.kt)("p",null,"You may use the tags ",(0,r.kt)("inlineCode",{parentName:"p"},"beta"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"latest"),", and ",(0,r.kt)("inlineCode",{parentName:"p"},"stable"),", or find out more\nat the ",(0,r.kt)("a",{parentName:"p",href:"https://hub.docker.com/r/ethsana/sana"},"Docker Hub repository"),"."),(0,r.kt)("h3",{id:"docker-compose"},"Docker Compose"),(0,r.kt)("p",null,"Configuration files for Sana and Sana Clef are provided to enable quick\nand easy installation of both programs with persistent storage and\nsecure secret management. To install Sana without Clef, simply omit the\nrelevant steps."),(0,r.kt)("h4",{id:"setup"},"Setup"),(0,r.kt)("p",null,"First, retrieve the current ",(0,r.kt)("inlineCode",{parentName:"p"},"docker-compose.yaml")," file."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"wget -q https://raw.githubusercontent.com/ethsana/sana/v0.0.3/packaging/docker/docker-compose.yml\n")),(0,r.kt)("p",null,"Next, create a ",(0,r.kt)("inlineCode",{parentName:"p"},".env")," file using the example file provided. This file will be responsible for storing configuration and secrets for our Bee and Bee Clef applications."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"wget -q https://raw.githubusercontent.com/ethsana/sana/v0.0.3/packaging/docker/env -O .env\n")),(0,r.kt)("p",null,"There are some important configuration parameters which must be set in order for our projects to work. To affect configuration in the ",(0,r.kt)("inlineCode",{parentName:"p"},".env")," file, we first remove the ",(0,r.kt)("inlineCode",{parentName:"p"},"#")," at the beginning of the line and then change the value after ",(0,r.kt)("inlineCode",{parentName:"p"},"=")," to our desired config."),(0,r.kt)("p",null,"For Sana, amend the following parameters:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"SANA_SWAP_ENDPOINT=https://stake.getblock.io/mainnet/?api_key=your-api-key\nSANA_PASSWORD=my-password\n")),(0,r.kt)("p",null,"To enable Clef support on mainnet, we must also change the following params: "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"CLEF_CHAINID=100\n")),(0,r.kt)("p",null,"For testnet, use chain id ",(0,r.kt)("inlineCode",{parentName:"p"},"5"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"SANA_CLEF_SIGNER_ENABLE=true\nSANA_CLEF_SIGNER_ENDPOINT=http://clef-1:8550\n")),(0,r.kt)("p",null,"With the configuration settings complete, you can start your Sana and\nClef nodes by running:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"docker-compose up -d\n")),(0,r.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"By specifying the ",(0,r.kt)("inlineCode",{parentName:"p"},"-d")," flag to ",(0,r.kt)("inlineCode",{parentName:"p"},"docker-compose")," we run Sana and Sana Clef as a daemon."))),(0,r.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Docker Compose will create a Docker Volume called ",(0,r.kt)("inlineCode",{parentName:"p"},"ant")," containing important key material. Make sure to ",(0,r.kt)("a",{parentName:"p",href:"/docs/access-the-ant/backups"},"backup")," the contents of your Docker volume!"))),(0,r.kt)("p",null,"To determine the Sana node's address to fund, we can check the logs for our Sana ",(0,r.kt)("em",{parentName:"p"},"container"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"docker-compose logs -f sana-1\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'sana_1 | time="2020-12-15T18:43:14Z" level=warning msg="cannot continue until there is sufficient ETH (for Gas) and at least 1 SANA available on 7a977fa660e2e93e1eba40030c6b8da68d01971e"\n')),(0,r.kt)("p",null,"Once you have determined your Sana's Ethereum addresses,\n",(0,r.kt)("a",{parentName:"p",href:"/docs/installation/fund-your-node"},"fund your node"),"."),(0,r.kt)("p",null,"After your transaction has been completed, your node should recognise that your wallet has been funded, and begin to deploy and fund your Bee chequebook!"),(0,r.kt)("p",null,"Once Sana has completed this procedure, you may query the Bee ",(0,r.kt)("a",{parentName:"p",href:"/docs/api-reference/api-reference"},"HTTP API")," at ",(0,r.kt)("inlineCode",{parentName:"p"},"http://localhost:1633"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"curl localhost:1633\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Ethereum Sana\n")),(0,r.kt)("p",null,"Once you start seeing messages in the ",(0,r.kt)("inlineCode",{parentName:"p"},"docker-compose logs -f sana-1"),"\nlike:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"successfully connected to peer 7fa40ce124d69ecf14d6f7806faaf9df5d639d339a9d343aa7004373f5c46b8f (outbound)\n")),(0,r.kt)("p",null,"You're connected to the Sana. Let's do a quick check to find out how\nmany peers we have using the ",(0,r.kt)("inlineCode",{parentName:"p"},"curl")," command line utility:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"curl localhost:1635/peers\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{"peers":[{"address":"339cf2ca75f154ffb8dd13de024c4a5c5b53827b8fd21f24bec05835e0cdc2e8"},{"address":"b4e5df012cfc281e74bb517fcf87fc2c07cd787929c332fc805f8124401fabae"} ]}\n\n')),(0,r.kt)("p",null,"If you see peers listed here - congratulations! You have joined the\nsana! Welcome!"))}d.isMDXComponent=!0}}]);