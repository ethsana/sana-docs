(self.webpackChunkant_docs=self.webpackChunkant_docs||[]).push([[803],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return p},kt:function(){return m}});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=a.createContext({}),d=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=d(e.components);return a.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),c=d(n),m=o,h=c["".concat(l,".").concat(m)]||c[m]||u[m]||r;return n?a.createElement(h,i(i({ref:t},p),{},{components:n})):a.createElement(h,i({ref:t},p))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,i=new Array(r);i[0]=c;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:o,i[1]=s;for(var d=2;d<r;d++)i[d]=n[d];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},5284:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return s},metadata:function(){return l},toc:function(){return d},default:function(){return u}});var a=n(2122),o=n(9756),r=(n(7294),n(3905)),i=["components"],s={title:"Starting a Test Network",id:"starting-a-test-network"},l={unversionedId:"ant-developers/starting-a-test-network",id:"ant-developers/starting-a-test-network",isDocsHomePage:!1,title:"Starting a Test Network",description:"A test network can be used to test your applications in an isolated environment before you deploy to Sana mainnet. It can be started by overriding the default configuration values of your Sana node. Throughout this tutorial, we will make use of configuration files to configure the nodes but of course you can also do the same using flags or environment variables (see Start your node).",source:"@site/docs/ant-developers/starting-a-test-network.md",sourceDirName:"ant-developers",slug:"/ant-developers/starting-a-test-network",permalink:"/docs/ant-developers/starting-a-test-network",editUrl:"https://github.com/ethsana/sana-docs/blob/master/sidebars.js/docs/ant-developers/starting-a-test-network.md",version:"current",frontMatter:{title:"Starting a Test Network",id:"starting-a-test-network"}},d=[{value:"Start a network on your own computer",id:"start-a-network-on-your-own-computer",children:[{value:"Configuration",id:"configuration",children:[]},{value:"Starting Your Nodes",id:"starting-your-nodes",children:[]},{value:"Making a network",id:"making-a-network",children:[]}]}],p={toc:d};function u(e){var t=e.components,n=(0,o.Z)(e,i);return(0,r.kt)("wrapper",(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"A test network can be used to test your applications in an isolated environment before you deploy to Sana mainnet. It can be started by overriding the default configuration values of your Sana node. Throughout this tutorial, we will make use of configuration files to configure the nodes but of course you can also do the same using flags or environment variables (see ",(0,r.kt)("a",{parentName:"p",href:"/docs/working-with-ant/configuration"},"Start your node"),"). "),(0,r.kt)("h2",{id:"start-a-network-on-your-own-computer"},"Start a network on your own computer"),(0,r.kt)("h3",{id:"configuration"},"Configuration"),(0,r.kt)("p",null,"Starting a network is easiest achieved by making use of configuration files. We need at least two nodes to start a network. Hence, below two configuration files are provided. Save them respectively as ",(0,r.kt)("inlineCode",{parentName:"p"},"config_1.yaml")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"config_2.yaml"),"."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"config_1.yaml")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},'network-id: 7357\napi-addr: :1633\np2p-addr: :1634\ndebug-api-addr: 127.0.0.1:1635\ndebug-api-enable: true\nbootnode: ""\ndata-dir: /tmp/ant/node1\npassword: some pass phze\nswap-enable: false\n')),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"config_2.yaml")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},'network-id: 7357\napi-addr: :1733\np2p-addr: :1734\ndebug-api-addr: 127.0.0.1:1735\ndebug-api-enable: true\ndata-dir: /tmp/ant/node2\nbootnode: ""\npassword: some pass phze\nwelcome-message: "Bzz Bzz Bzz"\nswap-enable: false\n')),(0,r.kt)("p",null,"Note that for each node, we provide a different ",(0,r.kt)("inlineCode",{parentName:"p"},"api-addr"),",\n",(0,r.kt)("inlineCode",{parentName:"p"},"debug-api-addr"),". If we had not specified different addresses here, we\nwould get an ",(0,r.kt)("inlineCode",{parentName:"p"},"address already in use")," error, as no two applications\ncan listen to the same port. We also specify a different\n",(0,r.kt)("inlineCode",{parentName:"p"},"p2p-addr"),". If we had not, our nodes would not be able to communicate\nwith each other. We also specify a separate ",(0,r.kt)("inlineCode",{parentName:"p"},"data-dir")," for each node,\nas each node must have its own separate key and chunk data store."),(0,r.kt)("p",null,"We also provide a network-id, so that our network remains separate\nfrom the Sana mainnet, which has network-id 1. Nodes will not connect\nto peers which have a different network id.  We also set our bootnode\nto be the empty string ",(0,r.kt)("inlineCode",{parentName:"p"},'""'),". A bootnode is responsible for\nbootstrapping the network so that a new node can find its first few\npeers before it begins its own journey to find friends in the\nSana. In Sana any node can be used as a bootnode. Later, we will\nmanually join our nodes together so in this case a bootnode isn't\nrequired."),(0,r.kt)("p",null,"Finally, note the ",(0,r.kt)("inlineCode",{parentName:"p"},"welcome-message")," in the first nodes configuration file. This is a friendly feature allowing you to send a message to peers that connect to you!"),(0,r.kt)("h3",{id:"starting-your-nodes"},"Starting Your Nodes"),(0,r.kt)("p",null,"Now we have created our configuration files, let's start our nodes by running ",(0,r.kt)("inlineCode",{parentName:"p"},"ant start --config config_1.yaml"),", then in another Terminal session, run ",(0,r.kt)("inlineCode",{parentName:"p"},"ant start --config-file config_2.yaml"),"."),(0,r.kt)("p",null,"We can now inspect the state of our network by sending HTTP requests to the ",(0,r.kt)("a",{parentName:"p",href:"/docs/api-reference/api-reference"},"Debug API"),".."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"curl -s http://localhost:1635/topology | jq .connected\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"0\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"curl -s http://localhost:1735/topology | jq .connected\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"0\n")),(0,r.kt)("p",null,"No connections yet? Right! Let's remedy that!"),(0,r.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Here we are using the ",(0,r.kt)("inlineCode",{parentName:"p"},"jq")," command line utility to count the amount of objects in the ",(0,r.kt)("inlineCode",{parentName:"p"},"peers")," array in the JSON response we have received from our Debug API, learn more about how to install and use ",(0,r.kt)("inlineCode",{parentName:"p"},"jq")," ",(0,r.kt)("a",{parentName:"p",href:"https://stedolan.github.io/jq/"},"here"),"."))),(0,r.kt)("h3",{id:"making-a-network"},"Making a network"),(0,r.kt)("p",null,"In order to create a network from our two isolated nodes, we must first instruct our nodes to connect to each other. This step is not explicitly needed if you connect to the main Sana network, as the default bootnodes in the Sana network will automatically suggest peers. "),(0,r.kt)("p",null,"First, we will need to find out the network address of the first node. To do this, we send a HTTP request to the ",(0,r.kt)("inlineCode",{parentName:"p"},"addresses")," endpoint of the Debug API. "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"curl localhost:1635/addresses | jq\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "overlay": "f57a65207f5766084d3ebb6bea5e2e4a712504e54d86a00961136b514f07cdac",\n  "underlay": [\n    "/ip4/127.0.0.1/tcp/1634/p2p/16Uiu2HAmUdCRWmyQCEahHthy7G4VsbBQ6dY9Hnk79337NfadKJEs",\n    "/ip4/192.168.0.10/tcp/1634/p2p/16Uiu2HAmUdCRWmyQCEahHthy7G4VsbBQ6dY9Hnk79337NfadKJEs",\n    "/ip6/::1/tcp/1634/p2p/16Uiu2HAmUdCRWmyQCEahHthy7G4VsbBQ6dY9Hnk79337NfadKJEs",\n    "/ip4/xx.xx.xx.xx/tcp/40317/p2p/16Uiu2HAmUdCRWmyQCEahHthy7G4VsbBQ6dY9Hnk79337NfadKJEs"\n  ]\n}\n')),(0,r.kt)("p",null,"Here, we get firstly the ",(0,r.kt)("strong",{parentName:"p"},"overlay address")," - this is the permanent address Sana uses as your anonymous identity in the network and secondly, a list of all the ",(0,r.kt)("a",{parentName:"p",href:"https://docs.libp2p.io/reference/glossary/#multiaddr"},"multiaddresses"),", which are physical network addresses at which you node can be found by peers. "),(0,r.kt)("p",null,"Note the addresses starting with an ",(0,r.kt)("inlineCode",{parentName:"p"},"/ip4"),", followed by ",(0,r.kt)("inlineCode",{parentName:"p"},"127.0.0.1"),", which is the ",(0,r.kt)("inlineCode",{parentName:"p"},"localhost")," internal network in your computer. Now we can use this full address to be the bootnode of our second node so that when it starts up, it goes to this address and both nodes become peers of each other. Let's add this into our config_2.yaml file. "),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"config_2.yaml")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},'network-id: 7357\napi-addr: :1733\np2p-addr: :1734\ndebug-api-addr: 127.0.0.1:1735\ndebug-api-enable: true\ndata-dir: /tmp/ant/node2\nbootnode: "/ip4/127.0.0.1/tcp/1634/p2p/16Uiu2HAmUdCRWmyQCEahHthy7G4VsbBQ6dY9Hnk79337NfadKJEs"\npassword: some pass phze\nwelcome-message: "Bzz Bzz Bzz"\nswap-enable: false\n')),(0,r.kt)("p",null,"Now, we can shut our second node and reboot with the new configuration."),(0,r.kt)("p",null,"Look at the the output for your first node, you should see our connection message!"),(0,r.kt)("p",null,"Let's also verify that we can see both nodes in using each other's Debug API's."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"curl -s http://localhost:1635/peers | jq\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"curl -s http://localhost:1635/peers | jq\n")),(0,r.kt)("p",null,"Congratulations! You have made your own tiny two ant Sana! \ud83d\udc1d \ud83d\udc1d"))}u.isMDXComponent=!0}}]);